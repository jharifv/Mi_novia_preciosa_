<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Ramo de Tulipanes</title>
  <meta name="description" content="Ramo interactivo de 3 tulipanes rosa pastel. Haz clic en cada flor para ver un mensaje en la parte superior." />
  <style>
    :root{
      --palo-rosa: #F8D7DA;
      --destello: rgba(255,255,255,0.88);
      --accent: #ff7ab6;
      --text: #222;
      --blur-strength: 6px;

      /* Ajustables: cambia para probar visual */
      --tulip-width: 220px;     /* ancho de cada tulipán */
      --tulip-overlap: 110px;   /* cuánto se solapan (incrementa para más solape) */
      --stage-bottom: 18px;     /* separación desde el borde inferior */
      --modal-top-offset: 6vh;  /* distancia desde top donde aparece el mensaje */
      --max-width: 1200px;
      --shadow: 0 12px 30px rgba(0,0,0,0.12);
      --radius: 18px;
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial;overflow:hidden}
    body{
      background: var(--palo-rosa);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:18px;
      color:var(--text);
    }

    /* Stage */
    #stage{
      position:relative;
      width:100%;
      max-width:var(--max-width);
      height:100vh;
      border-radius:12px;
      background: linear-gradient(180deg, rgba(255,255,255,0.45), rgba(255,255,255,0.15));
      box-shadow:var(--shadow);
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }

    /* Shimmer destellos */
    .shimmer{
      position:absolute;inset:0;pointer-events:none;z-index:2;
      background-image:
        radial-gradient(ellipse at 25% 20%, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.0) 20%),
        radial-gradient(ellipse at 75% 80%, rgba(255,255,255,0.9) 0%, rgba(255,255,255,0.0) 22%);
      opacity:0.9;mix-blend-mode:screen;filter:blur(6px);
      animation: shimmerMove 10s linear infinite;
    }
    @keyframes shimmerMove{0%{transform:translate(-6%,-4%) scale(1)}50%{transform:translate(6%,4%) scale(1.02)}100%{transform:translate(-6%,-4%) scale(1)}}

    /* RAMO: anclado abajo, centrado */
    .ramo{
      position:absolute;
      bottom:var(--stage-bottom);
      left:50%;
      transform:translateX(-50%);
      display:flex;
      align-items:flex-end;
      justify-content:center;
      gap:0; /* usamos margin negativo para solapar */
      z-index:10;
      pointer-events:auto;
      padding-bottom:6px;
    }

    /* cada tulip-wrap controla solape */
    .tulip-wrap{
      width:var(--tulip-width);
      display:flex;
      align-items:flex-end;
      justify-content:center;
      transform-origin:50% 100%;
      margin-left: calc(-1 * var(--tulip-overlap));
    }
    .tulip-wrap:first-child{ margin-left: 0; }

    /* control de apilamiento y rotaciones orgánicas */
    .tulip-wrap.pos1{ z-index:2; transform: translateY(12px) rotate(-8deg) scale(.98); }
    .tulip-wrap.pos2{ z-index:4; transform: translateY(6px) rotate(4deg) scale(1.06); } /* centro al frente */
    .tulip-wrap.pos3{ z-index:1; transform: translateY(12px) rotate(-4deg) scale(.98); }

    .tulip{
      width:100%;
      height:auto;
      display:block;
      border-radius:12px;
      cursor:pointer;
      user-select:none;
      box-shadow:0 10px 28px rgba(0,0,0,0.14);
      transition: transform .26s cubic-bezier(.2,.9,.3,1), filter .18s;
      will-change: transform, filter;
    }
    .tulip:active{ transform: translateY(6px) scale(.98); }
    .tulip:hover{ transform: translateY(-4px) scale(1.02); }

    /* animación de entrada */
    .tulip-wrap{ opacity:0; transform: translateY(18px) scale(.95); }
    .tulip-wrap:nth-child(1){ animation: popIn .7s .05s both cubic-bezier(.2,.9,.3,1); }
    .tulip-wrap:nth-child(2){ animation: popIn .7s .12s both cubic-bezier(.2,.9,.3,1); }
    .tulip-wrap:nth-child(3){ animation: popIn .7s .19s both cubic-bezier(.2,.9,.3,1); }
    @keyframes popIn{
      0%{ opacity:0; transform:translateY(18px) scale(.95); }
      60%{ opacity:1; transform:translateY(-6px) scale(1.03); }
      100%{ opacity:1; transform:translateY(0) scale(1); }
    }

    .ramo:after{
      content:'';
      position:absolute;
      bottom:6%;
      left:50%;
      transform:translateX(-50%);
      width:62%;
      height:20px;
      background:radial-gradient(ellipse at center, rgba(0,0,0,0.12), rgba(0,0,0,0.0));
      border-radius:50%;
      z-index:1;
    }

    /* OVERLAY: mensaje en la parte superior central */
    .overlay{
      position:fixed;
      inset:0;
      display:none;
      align-items:flex-start;       /* empuja al top */
      justify-content:center;
      background:rgba(0,0,0,0.36);
      z-index:60;
      padding-top: calc(var(--modal-top-offset));
      padding-bottom:20px;
    }
    .overlay.show{ display:flex; }

    .dialog{
      background: #fff;
      width: calc(100% - 36px);
      max-width: 640px;
      border-radius:12px;
      padding:16px 18px;
      box-shadow:0 18px 40px rgba(0,0,0,0.22);
      text-align:center;
    }
    .dialog h2{ margin:6px 0 8px; color:var(--accent); font-size:20px; }
    .dialog p{ margin:0; color:var(--text); line-height:1.4; font-size:16px; }

    /* Blur cuando modal abierto */
    .blurred{ filter: blur(var(--blur-strength)); transition: filter .24s; pointer-events:none; opacity:.99; }

    /* Responsive: reducir tulips en pantallas pequeñas */
    @media (max-width:420px){
      :root{ --tulip-width: 180px; --tulip-overlap: 90px; --modal-top-offset: 8vh; }
      .dialog{ width: calc(100% - 28px); padding:14px; }
    }
  </style>
</head>
<body>
  <div id="stage" role="main" aria-label="Ramo de tulipanes interactivo">
    <div class="shimmer" aria-hidden="true"></div>

    <div class="ramo" id="ramo" aria-hidden="false">
      <div class="tulip-wrap pos1"><img class="tulip" src="img/tulip1.jpg" alt="Tulipán 1" data-index="0"></div>
      <div class="tulip-wrap pos2"><img class="tulip" src="img/tulip2.jpg" alt="Tulipán 2" data-index="1"></div>
      <div class="tulip-wrap pos3"><img class="tulip" src="img/tulip3.jpg" alt="Tulipán 3" data-index="2"></div>
    </div>
  </div>

  <!-- Modal / overlay: sin botones visibles -->
  <div class="overlay" id="overlay" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="dialog" id="dialog">
      <h2 id="dialogTitle">Título editable</h2>
      <p id="dialogText">Texto editable por flor.</p>
    </div>
  </div>

  <script>
    /* -------------------------
       CONFIGURACIÓN: editables
       ------------------------- */
    const MESSAGES = [
      { title: "Mi amor", text: "Te quiero" },
      { title: "Mi novia", text: "Te adoro" },
      { title: "Mi vida", text: "Te amo!" }
    ];

    const TULIP_URLS = [
      'img/tulip1.jpg',
      'img/tulip2.jpg',
      'img/tulip3.jpg'
    ];

    const AUDIO_SRC = 'https://docs.google.com/uc?export=download&id=1VKw9AfTziD_mw7kVuIvX4eybVG-e9daG';

    /* -------------------------
       LÓGICA (no necesitas tocar)
       ------------------------- */
    const tulips = document.querySelectorAll('.tulip');
    const overlay = document.getElementById('overlay');
    const dialogTitle = document.getElementById('dialogTitle');
    const dialogText = document.getElementById('dialogText');
    const stage = document.getElementById('stage');

    // Aplicar imágenes (en caso quieras cambiar desde el arreglo)
    function applyTulips(){
      document.querySelectorAll('.tulip').forEach((img, i) => {
        img.src = TULIP_URLS[i % TULIP_URLS.length];
      });
    }
    applyTulips();

    // Audio: intenta autoplay, si falla se iniciará al primer click en una flor
    let audio = new Audio(AUDIO_SRC);
    audio.loop = true;
    audio.preload = 'auto';
    let audioStarted = false;

    function tryPlayAudio(){
      audio.play().then(()=>{ audioStarted = true; }).catch(()=>{ audioStarted = false; console.warn('Autoplay bloqueado'); });
    }
    window.addEventListener('load', tryPlayAudio);

    // Abrir modal (titulo + texto) y aplicar blur al stage
    let currentIndex = 0;
    function openModal(i){
      currentIndex = i;
      dialogTitle.textContent = MESSAGES[i].title;
      dialogText.textContent = MESSAGES[i].text;
      overlay.classList.add('show');
      overlay.setAttribute('aria-hidden','false');
      stage.classList.add('blurred');

      // si audio no ha iniciado, iniciarlo ahora (mejor UX en móviles)
      if(!audioStarted){
        audio.play().then(()=>{ audioStarted = true; }).catch(()=>{});
      }
    }

    function closeModal(){
      overlay.classList.remove('show');
      overlay.setAttribute('aria-hidden','true');
      stage.classList.remove('blurred');
    }

    // asignar eventos a las flores
    tulips.forEach((t, idx) => {
      t.addEventListener('click', () => {
        openModal(idx);
      });
    });

    // cerrar al tocar fuera del cuadro (overlay) o al presionar ESC
    overlay.addEventListener('click', (e) => {
      if(e.target === overlay) closeModal();
    });
    window.addEventListener('keydown', (e) => { if(e.key === 'Escape') closeModal(); });

    /* Nota:
       - Para editar mensajes: modifica el arreglo MESSAGES arriba.
       - Para cambiar imágenes: sube tus fotos a la carpeta img/ y actualiza TULIP_URLS (nombres exactos).
       - Si el audio no suena al abrir en GitHub Pages, sube el mp3 al repo y pon AUDIO_SRC = 'miAudio.mp3'.
    */
  </script>
</body>
</html>

